import{ak as _,aA as y,aj as H,r as C,j as e,B as l,T as U,af as J,ag as W,ai as M,al as N,am as Q,a5 as L,I as E,a as A,aB as K,E as F,ad as V,aC as O,R as Y,Z as ee,P as ne,ah as re,aD as ae}from"./index-wQ8JwfM2.js";import{T as le,a as B}from"./Table-cDawzk-H.js";import{a as $}from"./index-k6g5FF0C.js";import{u as P}from"./useQueryLecturer-y1xKae_S.js";import{v as z}from"./index-ZebsM1zJ.js";import{c as te}from"./person.validation-jxi8KQi5.js";import{a as ie,u as X}from"./useQueryLecturerTerm-QglJ35an.js";import{M as se,T as oe}from"./index--R3wRLoG.js";import"./KeyboardArrowRight-yT4WKBtg.js";import"./index-owcxqeif.js";import"./Stack-xq_Pr2sx.js";import"./useQueryGroupLecturer-Sp-7QLMU.js";import"./apiStudent-mO15R6c8.js";const de=[{_id:_.FEMALE,name:"Nữ"},{_id:_.MALE,name:"Nam"}];y.LECTURER,y.HEAD_LECTURER,y.HEAD_COURSE,y.ADMIN;const ce=[{name:"Tiến sĩ",_id:"MASTER"},{name:"Thạc sĩ",_id:"DOCTOR"}];function me(u){var g,T,R,r,S,v,k;const{onClose:t,open:d,lecturerId:s}=u,{majorStore:c}=H(),{handleGetLecturerById:o,onUpdateLecturer:f}=P(),{data:n,isLoading:h,isFetched:p}=o(s),{mutate:j,isSuccess:a}=f(s),i=x=>{j(x)};return C.useEffect(()=>{t()},[a]),e.jsx($,{maxWidth:"xs",open:d,onClose:t,children:e.jsxs(l,{py:10,px:10,children:[e.jsx(U,{mb:6,textTransform:"uppercase",children:"Cập nhật thông tin Giảng viên"}),h&&!p?e.jsx(l,{m:"auto",height:500,children:e.jsx(J,{})}):e.jsx(W,{onSubmit:x=>{i(x)},validationSchema:z,initialValues:{fullName:`${(g=n==null?void 0:n.lecturer)==null?void 0:g.fullName}`,username:`${(T=n==null?void 0:n.lecturer)==null?void 0:T.username}`,email:`${(R=n==null?void 0:n.lecturer)==null?void 0:R.email}`,phone:`${(r=n==null?void 0:n.lecturer)==null?void 0:r.phone}`,gender:`${(S=n==null?void 0:n.lecturer)==null?void 0:S.gender}`,degree:`${(v=n==null?void 0:n.lecturer)==null?void 0:v.degree}`,majorId:`${(k=n==null?void 0:n.lecturer)==null?void 0:k.majorId}`},children:({values:x,touched:b,handleChange:I,handleBlur:D,handleSubmit:Z,errors:m,setFieldValue:G})=>e.jsxs("form",{onSubmit:Z,children:[e.jsx(M,{value:x.username,name:"username",label:"Mã giảng viên",placeholder:"Mã Giảng viên",disabled:!0,onChange:I,onBlur:D,error:!!(m.username&&b.username),helperText:`${m.username&&b.username?m.username:""}`}),e.jsxs(l,{display:"flex",gap:10,mt:8,children:[e.jsx(l,{width:"100%",children:e.jsx(M,{required:!0,value:x.fullName,name:"fullName",label:"Họ và tên",onChange:I,onBlur:D,placeholder:"Họ và tên",error:!!(m.fullName&&b.fullName),helperText:`${m.fullName&&b.fullName?m.fullName:""}`})}),e.jsx(l,{width:200,children:e.jsx(N,{sx:{mb:8},value:`${x.gender}`,onChange:w=>{G("gender",w.target.value)},label:"Giới tính",options:de})})]}),e.jsx(M,{required:!0,name:"phone",value:x.phone,label:"Số điện thoại",placeholder:"Nhập vào số điện thoại",onChange:I,onBlur:D,error:!!(m.phone&&b.phone),helperText:`${m.phone&&b.phone?m.phone:""}`}),e.jsx(M,{required:!0,value:x.email,name:"email",label:"Email",placeholder:"Nhập vào email",onChange:I,onBlur:D,error:!!(m.email&&b.email),helperText:`${m.email&&b.email?m.email:""}`}),e.jsx(l,{mt:8,width:"full",children:e.jsx(N,{label:"Chuyên ngành",disabled:!0,value:x.majorId,onChange:w=>{G("majorId",w.target.value)},options:Q(c.allMajor)})})," ",e.jsx(l,{mt:8,width:"full"}),e.jsx(l,{mt:8,width:"full",children:e.jsx(N,{label:"Trình độ",value:x.degree,onChange:w=>{G("degree",w.target.value)},options:ce})})," ",e.jsxs(l,{mt:10,justifyContent:"end",gap:4,display:"flex",children:[e.jsxs(L,{variant:"contained",color:"primary",onClick:t,children:[e.jsx(E,{icon:"mdi:close-outline"}),"Hủy"]}),e.jsxs(L,{variant:"contained",color:"success",type:"submit",children:[e.jsx(E,{icon:"material-symbols:save-outline"}),"Cập nhật giảng viên"]})]})]})})]})})}function ue(u){const{onClose:t,open:d,lecturerId:s}=u,{onDeleteLecturerTerm:c}=ie(),{mutate:o,isSuccess:f}=c(),n=()=>{o(s)};return C.useEffect(()=>{t()},[f]),e.jsx($,{onClose:t,open:d,children:e.jsxs(l,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",px:10,py:12,children:[e.jsxs(l,{borderRadius:"50%",padding:3,sx:{background:"rgba(255,49,111,0.2)"},children:[e.jsx(E,{color:"#b31d1d82",height:70,width:70,icon:"fa-solid:trash-restore"})," "]}),e.jsx(A,{variant:"h3",mt:10,mb:14,children:"Bạn có chắc chắn muốn xóa giảng viên này ?"}),e.jsxs(l,{width:"100%",display:"flex",gap:6,marginTop:1,children:[e.jsxs(L,{onClick:t,sx:{width:"50%"},color:"primary",variant:"contained",children:[e.jsx(E,{width:20,style:{marginRight:4},icon:"mdi:cancel-outline"}),"Hủy"]}),e.jsxs(L,{type:"submit",sx:{width:"50%"},onClick:n,color:"error",variant:"contained",children:[e.jsx(E,{width:20,style:{marginRight:4},icon:"material-symbols:auto-delete-outline"}),"Xóa giảng viên"]})]})]})})}function he(u){const{rows:t,totalItems:d,currentTermId:s,totalPage:c,page:o,handleChangePage:f}=u,n=K(),[h,p]=C.useState({lecturerId:"",isOpen:!1}),j=()=>{p({...h,isOpen:!1})},a=r=>{p({lecturerId:r,isOpen:!0})},[i,g]=C.useState({lecturerId:"",isOpen:!1}),T=()=>{g({...i,isOpen:!1})},R=[{headerName:"Mã Giảng viên",field:"username",flex:.6,headerAlign:"center",align:"right",renderCell(r){return e.jsx(A,{variant:"body1",fontWeight:600,children:r.row.username})}},{headerName:"Họ & Tên đệm",field:"firstName",flex:.7,headerAlign:"left",align:"left"},{headerName:"Tên",field:"lastName",flex:.5,headerAlign:"left",align:"left"},{headerName:"Giới tính",field:"gender",flex:.5,headerAlign:"left",align:"left",renderCell:r=>e.jsx(A,{variant:"body1",children:te(r.row.gender)})},{headerName:"SĐT",field:"phone",flex:1,headerAlign:"center",align:"center",renderCell:r=>e.jsx(A,{variant:"body1",children:r.row.phone})},{headerName:"Email",field:"email",flex:1.2,headerAlign:"left",align:"left",renderCell:r=>e.jsx(A,{variant:"body1",children:r.row.email})},{headerName:"Chức năng",field:"updateTing",flex:1,headerAlign:"center",align:"center",renderCell:r=>e.jsxs(l,{display:"flex",gap:2,children:[e.jsx(B,{onClick:()=>a(r.row.id),title:"Cập nhật thông tin",children:e.jsx(F,{children:e.jsx(E,{width:20,icon:"fa-solid:user-edit",style:{color:"#0288d1"}})})}),e.jsx(l,{}),e.jsx(B,{onClick:()=>n(`/lecturers/detail/${r.row.id}`),title:"Xem Chi tiết",children:e.jsx(F,{color:"primary",children:e.jsx(E,{width:20,icon:"flat-color-icons:view-details"})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(l,{children:e.jsx(le,{rows:t,sx:{bgcolor:"white",width:"100%"},columns:R,totalItems:d,totalPages:c,page:o,handleChangePage:f,disableColumnMenu:!0,disableColumnFilter:!0,disableColumnSelector:!0,minHeight:400})}),e.jsx(me,{lecturerId:h.lecturerId,open:h.isOpen,onClose:j,currentTermId:s}),e.jsx(ue,{lecturerId:i.lecturerId,open:i.isOpen,onClose:T})]})}const pe=[{_id:_.FEMALE,name:"Nữ"},{_id:_.MALE,name:"Nam"}];y.LECTURER,y.HEAD_LECTURER,y.HEAD_COURSE,y.ADMIN;const q=[{name:"Thạc sĩ",_id:"DOCTOR"},{name:"Tiến sĩ",_id:"MASTER"}];function ge(u){var j;const{onClose:t,open:d}=u,{termStore:s}=V(),{majorStore:c}=H(),{currentTerm:o}=s,{onCreateLecturer:f}=P(),{mutate:n,isSuccess:h}=f(),p=a=>{var i={username:a.username,fullName:a.fullName,gender:a.gender,email:a.email,phone:a.phone,degree:a.degree,role:"LECTURER",majorId:a.majorId,termId:o.id};n(i)};return C.useEffect(()=>{t()},[h]),e.jsx($,{maxWidth:"xs",open:d,onClose:t,children:e.jsxs(l,{py:10,px:10,children:[e.jsx(U,{mb:8,variant:"h5",textTransform:"uppercase",children:"Tạo thông tin Giảng viên"}),e.jsx(W,{onSubmit:a=>{p(a)},validationSchema:z,initialValues:{fullName:"",username:"",email:"",phone:"",gender:_.MALE,role:"",degree:(j=q[0])==null?void 0:j._id,majorId:`${c.currentMajor.id}`},children:({values:a,touched:i,handleChange:g,handleBlur:T,handleSubmit:R,errors:r,setFieldValue:S})=>e.jsxs("form",{onSubmit:R,children:[e.jsx(M,{required:!0,value:a.username,name:"username",label:"Mã giảng viên",placeholder:"Mã Giảng viên",onChange:g,onBlur:T,error:!!(r.username&&i.username),helperText:r.username&&i.username?r.username:""}),e.jsxs(l,{display:"flex",gap:10,mt:8,children:[e.jsx(l,{width:"100%",children:e.jsx(M,{required:!0,value:a.fullName,name:"fullName",label:"Họ và tên",onChange:g,onBlur:T,placeholder:"Họ và tên",error:!!(r.fullName&&i.fullName),helperText:r.fullName&&i.fullName?r.fullName:""})}),e.jsx(l,{width:200,children:e.jsx(N,{sx:{mb:8},value:`${a.gender}`,onChange:v=>{S("gender",v.target.value)},label:"Giới tính",options:pe})})]}),e.jsx(M,{required:!0,name:"phone",value:a.phone,label:"Số điện thoại",placeholder:"Nhập vào số điện thoại",onChange:g,onBlur:T,error:!!(r.phone&&i.phone),helperText:r.phone&&i.phone?r.phone:""}),e.jsx(M,{required:!0,value:a.email,name:"email",label:"Email",placeholder:"Nhập vào email",onChange:g,onBlur:T,error:!!(r.email&&i.email),helperText:r.email&&i.email?r.email:""}),e.jsx(l,{mt:8,width:"full",children:e.jsx(N,{label:"Chuyên ngành",value:c.currentMajor.id,disabled:!0,onChange:v=>{S("majorId",v.target.value)},options:Q(c.allMajor)})})," ",e.jsx(l,{mt:8,width:"full",children:e.jsx(N,{label:"Trình độ",value:a.degree,onChange:v=>{S("degree",v.target.value)},options:q})})," ",e.jsxs(l,{mt:10,justifyContent:"end",gap:4,display:"flex",children:[e.jsxs(L,{variant:"contained",color:"primary",onClick:t,children:[e.jsx(E,{icon:"mdi:close-outline"}),"Hủy"]}),e.jsxs(L,{variant:"contained",color:"success",type:"submit",children:[e.jsx(E,{icon:"material-symbols:save-outline"}),"Tạo giảng viên"]})]})]})})]})})}const xe=[{_id:O.SEARCH_FULLNAME,name:"Tên giảng viên"},{_id:O.SEARCH_USERNAME,name:"Mã giảng viên"},{_id:O.SEARCH_PHONE,name:"Số điện thoại"},{_id:O.SEARCH_EMAIL,name:"Email"}];function fe(){const[u,t]=C.useState(!1),{onSearchChange:d,getQueryField:s,onTypeSearchChange:c,handleFocused:o,setDefaultTypeSearch:f}=X(),n=()=>{t(!1)},h=()=>{t(!0)},{termStore:p}=V(),{currentTerm:j}=p;return e.jsxs(e.Fragment,{children:[e.jsxs(l,{mb:4,display:"flex",flexWrap:"wrap",gap:2,children:[e.jsxs(l,{flex:1,display:"flex",gap:4,width:"full",children:[e.jsx(l,{width:200,children:e.jsx(N,{defaultValue:s("searchField")?s("searchField"):"username",onChange:a=>c(`${a.target.value}`),options:xe})}),e.jsx(ee,{fullWidth:!0,size:"small",defaultValue:s("keywords"),onChange:d,onBlur:()=>o(!1),placeholder:"Tim kiếm giảng viên theo.."})]}),e.jsxs(L,{size:"small",color:"error",type:"button",onClick:h,variant:"contained",children:[e.jsx(E,{icon:"lets-icons:add-round",width:20}),"Tạo Giảng viên"]}),e.jsx(se,{label:"Tải lên Excel Giảng viên",entityUpload:oe.LECTURER,termId:j.id})]}),e.jsx(ge,{open:u,onClose:n})]})}const je=Y.memo(fe);function _e(){const{handleGetAllLecturer:u,paramTotalPage:t}=P(),{majorStore:d}=H();C.useState(10);const[s,c]=C.useState(1),{data:o,isLoading:f,isFetching:n,refetch:h}=u(),{setLimit:p,setPage:j,getQueryField:a}=X();C.useEffect(()=>{p(10),j(s)},[s]),C.useEffect(()=>{p(10),a("keywords")===""&&h()},[a("keywords")]);const i=g=>{c(g)};return e.jsxs(ne,{sx:{py:10,px:10},elevation:1,children:[e.jsxs(U,{mb:8,mt:2,children:["Danh sách Giảng viên ",d!=null&&d.currentMajor?d.currentMajor.name:""]}),e.jsxs(e.Fragment,{children:[e.jsx(je,{}),f?e.jsx(re,{}):e.jsx(he,{rows:ae(o==null?void 0:o.lecturers),totalPage:t,totalItems:o==null?void 0:o.lecturers.length,handleChangePage:i,page:s})]})]})}export{_e as default};
