import{r as x,j as e,B as t,a as S,aa as O,u as L,bf as _,T as j,ag as P,c as D,ai as y,ak as M,a5 as b,I as T,P as v,ah as E}from"./index-NapbxlsL.js";import{T as k}from"./Table-WHKjjRLK.js";import{a as G}from"./index-qC6u9U62.js";import{T as Q}from"./index-iG0vRBui.js";import"./KeyboardArrowRight-5D6Ejjzb.js";import"./index-UQJd2y-u.js";import"./Stack-ScuxqrBn.js";function B(o){const{rows:a,totalItems:s,totalPages:r,page:h,handelChangePage:i,...u}=o;x.useState({isOpen:!1,notificationId:0}),x.useState({isOpen:!1,notificationId:0});const g=[{headerName:"Ngày Tạo",field:"created_at",flex:.8,headerAlign:"center",align:"center",renderCell:l=>e.jsx(e.Fragment,{children:e.jsx(S,{children:O(l.row.created_at).format("DD/MM/YYYY hh:ss")})})},{headerName:"Nội dung",field:"message",flex:5,headerAlign:"center",align:"left",renderCell(l){return e.jsx(t,{children:e.jsx(S,{variant:"body1",color:"initial",dangerouslySetInnerHTML:{__html:l.row.message}})})}},{headerName:"",field:"name9",flex:1,headerAlign:"center",align:"center",renderCell:l=>e.jsx(t,{display:"flex",gap:6})}];return e.jsxs(t,{...u,children:[" ",e.jsx(k,{rows:a,sx:{bgcolor:"white"},rowHeight:200,columns:g,totalItems:1,totalPages:1,page:1,handleChangePage:()=>{},disableColumnMenu:!0,disableColumnFilter:!0,disableColumnSelector:!0})]})}const I=[{_id:"students",name:"Gửi đến Sinh viên"},{_id:"lecturers",name:"Gửi đến Giảng viên"}],F=[{_id:"many",name:"Tất cả"},{_id:"one",name:"Duy nhất"}];function Y(o){const a=I.find(s=>s._id===o);return a?a.name:null}const U=(o,a,s,r)=>"<h5>"+o+" "+Y(a)+" </h5> <br/> <h3> Tiêu đề: "+s+" </h3> <br/> <h4> Nội dung cụ thể: </h4>"+r;function H(o){const{open:a,onClose:s,termId:r,type:h}=o,{lecturerStore:i}=L(),{onCreateAllNotificationStudentTerms:u,onCreateAllNotificationLecturerTerms:g}=_(),{mutate:l,isSuccess:N}=u(),{mutate:R,isSuccess:C}=g(),w=n=>{const d=U(n.role,n.typeRoleSended,n.messageName,n.messageContent);n.typeQuantitySended==="many"&&n.typeRoleSended==="students"?l(d):n.typeQuantitySended==="many"&&n.typeRoleSended==="lecturers"&&R(d)};return x.useEffect(()=>{(C||N)&&s()},[C,N]),e.jsx(G,{maxWidth:"lg",open:a,onClose:s,children:e.jsxs(t,{px:6,py:6,children:[e.jsx(j,{textTransform:"uppercase",icon:"material-symbols:circle-notifications-rounded",my:6,children:"Tạo thông báo mới"}),e.jsx(P,{onSubmit:n=>w(n),initialValues:{type:h,termId:r,name:`${i.me.user.fullName}`,typeQuantitySended:"many",typeRoleSended:"students",messageName:"",messageContent:"",role:`${D(i.currentRoleRender)}`},children:({handleBlur:n,handleChange:d,handleSubmit:A,values:c,setFieldValue:f,touched:W,errors:m})=>e.jsxs("form",{onSubmit:A,children:[e.jsxs(t,{display:"flex",gap:10,px:10,children:[e.jsx(y,{onBlur:n,onChange:d,error:!!m.name,disabled:!0,label:"Vai trò",name:"role",placeholder:"Vai trò Người gửi ",value:c.role}),e.jsx(t,{width:"100%",children:e.jsx(y,{fullWidth:!0,onBlur:n,onChange:d,error:!!m.name,disabled:!0,label:"Tên người gửi",placeholder:"Tên người gửi ",name:"name",value:c.name})})]}),e.jsxs(t,{bgcolor:"grey.50",px:10,pb:4,children:[e.jsx(j,{variant:"body1",textTransform:"uppercase",icon:"ph:user-list",mb:6,children:"Người nhận"}),e.jsx(t,{mb:6,children:e.jsxs(t,{display:"flex",gap:10,children:[e.jsx(M,{placeholder:"",label:"Số lượng người nhận",value:c.typeQuantitySended,onChange:p=>{f("typeQuantitySended",p.target.value)},options:F}),e.jsx(t,{width:"100%",children:e.jsx(M,{placeholder:"",label:"Gửi Thông báo tới",value:c.typeRoleSended,onChange:p=>{f("typeRoleSended",p.target.value)},options:I})})]})}),e.jsx(y,{name:"messageName",onBlur:n,onChange:d,error:!!m.messageName,helperText:m.messageName,label:"Tiêu đề thông báo",placeholder:"Tên thông báo ",id:"messageName",value:c.messageName}),e.jsx(Q,{label:"Nội dung thông báo",errors:!!m.messageContent,placeholder:"Nhập vào nội dung thông báo",value:c.messageContent,onChange:p=>{f("messageContent",p)},id:"messageContent",helperText:m.messageContent})]}),e.jsxs(t,{mt:4,justifyContent:"end",gap:4,display:"flex",children:[e.jsxs(b,{variant:"contained",color:"primary",onClick:s,children:[e.jsx(T,{icon:"mdi:close-outline"}),"Hủy"]}),e.jsxs(b,{variant:"contained",color:"success",type:"submit",children:[e.jsx(T,{icon:"tabler:send"}),"Gửi thông báo"]})]})]})})]})})}function Z(){const[o,a]=x.useState(!1),s=()=>{a(!0)},r=()=>{a(!1)},{handleGetAllNotificationsOfLecturer:h}=_(),{data:i,isFetching:u,isLoading:g}=h();return e.jsx(e.Fragment,{children:e.jsxs(v,{sx:{py:10,px:10},elevation:1,children:[e.jsxs(t,{display:"flex",justifyContent:"space-between",children:[e.jsx(j,{icon:"basil:notification-on-outline",mb:4,mt:2,children:"Danh sách thông báo"}),e.jsxs(b,{onClick:s,color:"error",variant:"contained",size:"small",children:[e.jsx(T,{width:16,icon:"material-symbols:add"}),"Thêm thông báo mới"," "]})]}),g||u?e.jsx(E,{}):e.jsx(t,{width:"full",my:4,children:e.jsx(B,{rows:i==null?void 0:i.notificationLecturers})}),e.jsx(e.Fragment,{children:e.jsx(H,{open:o,onClose:r})})]})})}export{Z as default};
