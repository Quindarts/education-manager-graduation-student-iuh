import{r as g,j as e,B as l,I as p,a as o,a5 as C,E as L,ad as M,T as S,ah as k,ai as F,P as D,bd as P,aC as v,ak as R,Z as H,aj as _,aD as G}from"./index-NapbxlsL.js";import{T as O,a as V,A as B,D as E}from"./Table-WHKjjRLK.js";import{c as U}from"./person.validation-jxi8KQi5.js";import{a as I}from"./index-qC6u9U62.js";import{u as w}from"./useQueryLecturerTerm-aT1-fx4u.js";import{u as N}from"./useParams-vd7i9Ic6.js";import"./KeyboardArrowRight-5D6Ejjzb.js";import"./index-UQJd2y-u.js";import"./Stack-ScuxqrBn.js";function W(c){const{onClose:r,open:i,lecturerId:m,name:d}=c,{onDeleteLecturerTerm:u}=w(),{mutate:t,isSuccess:a}=u(),x=()=>{t(m)};return g.useEffect(()=>{r()},[a]),e.jsx(I,{onClose:r,open:i,children:e.jsxs(l,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",px:10,py:12,children:[e.jsxs(l,{p:10,borderRadius:"50%",sx:{background:"rgba(255,49,111,0.2)"},children:[e.jsx(p,{color:"#b31d1d82",height:70,width:70,icon:"streamline:emergency-exit"})," "]}),e.jsxs(o,{textAlign:"center",variant:"h3",mt:10,mb:14,children:["Bạn có chắc chắn muốn bỏ GV ",d," ra khỏi học kì này?"]}),e.jsxs(l,{width:"100%",display:"flex",gap:6,marginTop:1,children:[e.jsxs(C,{onClick:r,sx:{width:"50%"},color:"primary",variant:"contained",children:[e.jsx(p,{width:20,style:{marginRight:4},icon:"mdi:cancel-outline"}),"Hủy"]}),e.jsxs(C,{type:"submit",sx:{width:"50%"},onClick:x,color:"error",variant:"contained",children:[e.jsx(p,{width:20,style:{marginRight:4},icon:"material-symbols:auto-delete-outline"}),"Bỏ giảng viên"]})]})]})})}function z(c){const{rows:r,totalItems:i,totalPage:m,page:d,handleChangePage:u}=c,[t,a]=g.useState({lecturerId:"",name:"",isOpen:!1}),x=()=>{a({...t,isOpen:!1})},j=(n,y)=>{a({lecturerId:n,name:y,isOpen:!0})},f=[{headerName:"Mã Giảng Viên",field:"username",flex:.6,headerAlign:"center",align:"right",renderCell(n){return e.jsx(o,{variant:"body1",fontWeight:600,children:n.row.username})}},{headerName:"Họ & Tên đệm",field:"firstName",flex:.7,headerAlign:"left",align:"left"},{headerName:"Tên",field:"lastName",flex:.5,headerAlign:"left",align:"left"},{headerName:"Chuyên ngành",field:"majorName",flex:1,headerAlign:"left",align:"left"},{headerName:"Giới tính",field:"gender",flex:.5,headerAlign:"left",align:"left",renderCell:n=>e.jsx(o,{variant:"body1",children:U(n.row.gender)})},{headerName:"Email",field:"email",flex:1.2,headerAlign:"left",align:"left",renderCell:n=>e.jsx(o,{variant:"body1",children:n.row.email})},{headerName:"SĐT",field:"phone",flex:1,headerAlign:"center",align:"center",renderCell:n=>e.jsx(o,{variant:"body1",children:n.row.phone})},{headerName:"Chức năng",field:"updateTing",flex:.5,headerAlign:"center",align:"center",renderCell:n=>e.jsx(l,{display:"flex",gap:2,children:e.jsx(V,{title:"Gỡ giảng viên khỏi học kì",children:e.jsx(L,{color:"error",onClick:()=>j(n.row.id,n.row.fullName),children:e.jsx(p,{width:20,icon:"material-symbols:digital-out-of-home-rounded"})})})})}];return e.jsxs(e.Fragment,{children:[e.jsx(l,{children:e.jsx(O,{rows:r,sx:{bgcolor:"white",width:"100%"},columns:f,totalItems:i,totalPages:m,page:d,handleChangePage:u,disableColumnMenu:!0,disableColumnFilter:!0,disableColumnSelector:!0,minHeight:400})}),e.jsx(W,{lecturerId:t.lecturerId,open:t.isOpen,onClose:x,name:t.name})]})}const Q=c=>c?c.map(r=>({label:r.nameSelect,id:r.lecturerId})):[];function $(c){const{onClose:r,open:i}=c,{termStore:m}=M(),{currentTerm:d}=m,{handleLecturerTermsToAdd:u,onCreateLecturerTerm:t}=w(),{data:a,isLoading:x,isSuccess:j,isFetching:f}=u(),{mutate:n,isSuccess:y}=t(),[h,b]=g.useState({label:"",id:""}),A=s=>{const T={lecturerId:s.id,termId:`${d.id}`};n(T)};return g.useEffect(()=>{r()},[y]),g.useEffect(()=>{i||b({label:"",id:""})},[i]),e.jsx(I,{maxWidth:"sm",open:i,onClose:r,children:e.jsxs(l,{py:10,px:10,children:[e.jsx(S,{mb:8,variant:"h5",textTransform:"uppercase",children:"Thêm Giảng viên vào học kì"}),e.jsx(l,{height:"350px",children:x||f?e.jsx(k,{}):e.jsxs(e.Fragment,{children:[e.jsx(B,{disablePortal:!0,id:"lecturer-terms-list",options:Q(a==null?void 0:a.lecturerTerms),onChange:(s,T)=>{b(T)},onInputChange:(s,T)=>{},renderInput:s=>e.jsx(e.Fragment,{children:e.jsx(F,{...s,placeholder:"Nhập vào tên giảng viên",label:"Danh sách giảng viên HD khoa CNTT"})})}),e.jsxs(l,{children:[e.jsx(o,{textTransform:"uppercase",mt:20,mb:4,variant:"body1",fontWeight:"bold",children:"Thông tin giảng viên"}),!h||(h==null?void 0:h.id)===""?e.jsx(e.Fragment,{children:e.jsx(o,{my:10,textAlign:"center",variant:"body1",color:"initial",children:"Chưa chọn giảng viên nào..."})}):e.jsx(l,{children:a==null?void 0:a.lecturerTerms.filter(s=>s.lecturerId===(h==null?void 0:h.id)).map(s=>e.jsxs(D,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",p:3,borderRadius:2,boxShadow:1,mt:4},children:[e.jsx(o,{variant:"h6",component:"div",gutterBottom:!0,sx:{fontWeight:"500",my:4},children:s.fullName}),e.jsx(E,{sx:{width:"100%",mb:2}}),e.jsxs(l,{sx:{my:6},children:[e.jsxs(o,{variant:"body1",color:"text.primary",children:[e.jsx("strong",{children:"Mã GV:"})," ",s.username]}),e.jsxs(o,{variant:"body1",color:"text.primary",children:[e.jsx("strong",{children:"Email:"})," ",s.email]}),e.jsxs(o,{variant:"body1",color:"text.primary",children:[e.jsx("strong",{children:"Trình độ:"})," ",P(s.degree)]}),e.jsxs(o,{variant:"body1",color:"text.primary",children:[e.jsx("strong",{children:"Chuyên ngành:"})," ",s.majorName]})]}),e.jsx(E,{sx:{width:"100%",mb:2}}),e.jsx(o,{variant:"body2",color:"primary.dark",children:s.nameSelect})]}))})]})]})}),e.jsxs(l,{mt:10,justifyContent:"end",gap:4,display:"flex",children:[e.jsxs(C,{variant:"contained",color:"primary",onClick:r,children:[e.jsx(p,{icon:"mdi:close-outline"}),"Hủy"]}),e.jsxs(C,{variant:"contained",color:"error",onClick:()=>A(h),type:"submit",children:[e.jsx(p,{icon:"material-symbols:save-outline"}),"Thêm GV hướng dẫn"]})]})]})})}const Z=[{_id:v.SEARCH_FULLNAME,name:"Tên giảng viên"},{_id:v.SEARCH_USERNAME,name:"Mã giảng viên"},{_id:v.SEARCH_PHONE,name:"Số điện thoại"},{_id:v.SEARCH_EMAIL,name:"Email"}];function q(){const[c,r]=g.useState(!1),i=()=>{r(!1)},m=()=>{r(!0)},{onImportLecturerTerm:d}=w(),{mutate:u}=d(),{onSearchChange:t,getQueryField:a,onTypeSearchChange:x,handleFocused:j}=N(),f=()=>{u()};return e.jsxs(e.Fragment,{children:[e.jsxs(l,{mb:4,display:"flex",flexWrap:"wrap",gap:2,children:[e.jsxs(l,{flex:1,display:"flex",gap:4,width:"full",children:[e.jsx(l,{width:200,children:e.jsx(R,{defaultValue:a("searchField")?a("searchField"):"username",onChange:n=>x(`${n.target.value}`),options:Z})}),e.jsx(H,{fullWidth:!0,size:"small",defaultValue:a("keywords"),onChange:t,onBlur:()=>j(!1),placeholder:"Tim kiếm giảng viên HD theo.."})]}),e.jsxs(C,{color:"primary",variant:"contained",onClick:f,children:[e.jsx(p,{icon:"fe:import"}),"Tải dữ liệu GV học kì trước"]}),e.jsxs(C,{size:"small",color:"error",type:"button",onClick:m,variant:"contained",children:[e.jsx(p,{icon:"lets-icons:add-round",width:20}),"Thêm giảng viên HD"]})]}),e.jsx($,{open:c,onClose:i})]})}function ie(){var b;const{handleGetAllLecturerTermByParam:c,paramTotalPage:r}=w(),{majorStore:i}=_(),{termStore:m}=M(),[d,u]=g.useState(1),{data:t,isLoading:a,isFetching:x,refetch:j}=c(),f=A=>{u(A)},{setLimit:n,setPage:y,getQueryField:h}=N();return g.useEffect(()=>{n(10),y(d)},[d]),g.useEffect(()=>{n(10),y(1),h("keywords")===""&&j()},[h("keywords")]),e.jsxs(D,{sx:{py:10,px:10},elevation:1,children:[e.jsxs(S,{mb:8,mt:2,children:["Danh sách giảng viên ",i!=null&&i.currentMajor?i.currentMajor.name:""," -"," ",m.currentTerm.name]}),e.jsxs(e.Fragment,{children:[e.jsx(q,{}),a&&!x?e.jsx(k,{}):e.jsx(z,{rows:G(t==null?void 0:t.lecturerTerms),totalPage:r,totalItems:(b=t==null?void 0:t.lecturerTerms)==null?void 0:b.length,handleChangePage:f,page:d})]})]})}export{ie as default};
