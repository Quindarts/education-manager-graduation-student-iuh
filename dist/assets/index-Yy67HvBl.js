import{j as e,P as m,B as t,A as Q,a as o,E as X,I as u,R as V,ad as B,r as _,ai as H,ah as z,a5 as A,ak as Z,T as N}from"./index-NapbxlsL.js";import{u as $}from"./useQueryGroupLecturer-YqNk0Zqv.js";import{u as Y}from"./useQueryLecturerTerm-aT1-fx4u.js";import{a as g,b as I}from"./groupLecturer.validation-KscKIZ_D.js";import{C as q}from"./KeyboardArrowRight-5D6Ejjzb.js";import{a as k,b as ee,T as M}from"./TabPanel-RkIgX_6D.js";import{a as W}from"./Tabs-IDt9DQ5z.js";import"./useParams-vd7i9Ic6.js";function J(s){const{key:d,id:a,draggable:h,onDragStart:f,onDragEnd:j,lecturer:b}=s;return e.jsxs(m,{id:a,draggable:h,onDragStart:f,onDragEnd:j,sx:{my:6,py:2,px:10,display:"flex",cursor:"pointer",gap:20,justifyContent:"space-around",borderRadius:2,boxSizing:"border-box",border:"2px solid #fefefe",":hover":{border:"2px solid #0052b1",transition:"0.1s ease-in",backgroundColor:"#D3E7FF",boxShadow:"0 10px 20px rgba(166, 165, 165, 0.3), 0 6px 6px rgba(235, 235, 235, 0.23)"}},children:[e.jsx(t,{children:e.jsx(Q,{sizes:"small",src:""})}),e.jsxs(t,{flex:1,children:[e.jsxs(o,{variant:"body1",fontWeight:500,color:"grey.700",children:["Tên giảng viên",e.jsx(o,{mx:4,component:"span",children:b.fullName}),e.jsx(o,{ml:10,component:"span",textAlign:"end"})]}),e.jsxs(o,{variant:"body1",fontWeight:500,color:"grey.700",children:["Mã giảng viên",e.jsx(o,{mx:4,component:"span",children:b.username})]})]}),e.jsx(t,{children:e.jsx(X,{size:"small",children:e.jsx(u,{icon:"mingcute:more-2-fill",style:{color:"#0052b1"}})})})]},d)}const re=s=>{if(!s)return[];const d=[];return s.map(a=>{let h=a.lecturer;d.push({...h,lecturerTerm:a,status:g.NO_GROUP})}),d};function ne(){const[s,d]=V.useState(),{onCreateGroupLecturer:a}=$(),{handleGetListLecturerTerms:h}=Y(),{termStore:f}=B(),{data:j,isLoading:b,isSuccess:w,isFetched:R}=h(),{mutate:F,isSuccess:P}=a("reviewer"),L=()=>{let r=s==null?void 0:s.filter(p=>p.status===g.HAVE_GROUP);const i=r==null?void 0:r.map(p=>p.id);F({termId:f.currentTerm.id,lecturers:i})};_.useEffect(()=>{d(re(j==null?void 0:j.lecturerTerms))},[P,R]);const D=r=>{r.currentTarget.classList.add("dragged"),r.dataTransfer.setData("text/plain",r.currentTarget.id),r.dataTransfer.effectAllowed="move"},U=r=>{r.currentTarget.classList.remove("dragged")},v=r=>{r.preventDefault(),r.currentTarget.classList.add("dragged-over"),r.dataTransfer.dropEffect="move"},T=r=>{let i=r.currentTarget,p=r.relatedTarget;if(p.parentNode===i||p===i)return;r.preventDefault(),r.currentTarget.classList.remove("dragged-over")},E=r=>{r.preventDefault(),r.dataTransfer.dropEffect="move"},O=(r,i,p)=>{r.preventDefault(),r.currentTarget.classList.remove("dragged-over");let n=r.dataTransfer.getData("text/plain"),c=s==null?void 0:s.map(x=>{var C;return((C=x==null?void 0:x.id)==null?void 0:C.toString())===(n==null?void 0:n.toString())&&(x.status=p),x});d(c)};let l=s==null?void 0:s.filter(r=>r.status===g.HAVE_GROUP),y=s==null?void 0:s.filter(r=>r.status===g.NO_GROUP);return e.jsxs(t,{display:"flex",py:10,px:0,gap:20,justifyContent:"space-between",children:[e.jsxs(m,{onDragLeave:r=>T(r),onDragEnter:r=>v(r),onDragEnd:r=>U(r),onDragOver:r=>E(r),onDrop:r=>O(r,!1,g.NO_GROUP),sx:{flex:1},elevation:1,children:[e.jsxs(t,{px:10,bgcolor:"grey.200",py:4,mb:4,children:[e.jsxs(o,{mb:4,variant:"h6",color:"primary",children:[e.jsx(u,{icon:"ic:baseline-list"}),"Danh sách giảng viên trống lịch"]}),e.jsx(t,{bgcolor:"white",children:e.jsx(H,{placeholder:"Tim kiem giang vien"})})]}),e.jsx(t,{sx:{overflowY:"auto"},height:500,px:4,children:b||!R?e.jsx(z,{}):e.jsx(t,{children:y==null?void 0:y.map(r=>e.jsx(J,{id:r.id,lecturer:r,draggable:!0,onDragStart:i=>D(i),onDragEnd:i=>D(i)},r.id))})})]}),e.jsxs(m,{sx:{flex:1,px:6,height:400,py:10,borderTop:"5px solid #0052b1"},onDragLeave:r=>T(r),onDragEnter:r=>v(r),onDragEnd:r=>U(r),onDragOver:r=>E(r),onDrop:r=>O(r,!1,g.HAVE_GROUP),children:[e.jsxs(o,{variant:"h6",color:"primary",children:[e.jsx(u,{icon:"gridicons:create"}),"Tạo nhóm chấm phản biện"]}),l&&l.length<1?e.jsx(t,{display:"flex",sx:{cursor:"progress"},flexDirection:"column",height:500,children:e.jsxs(t,{display:"flex",flexDirection:"column",gap:10,alignItems:"center",children:[e.jsx(o,{color:"grey.500",variant:"h6",mt:20,children:"Vui lòng kéo thả giảng viên..."}),e.jsx(u,{color:"#dfdfdf",width:100,icon:"icon-park-solid:hand-left"})]})}):e.jsxs(t,{sx:{minHeight:200},children:[l==null?void 0:l.map(r=>e.jsxs(m,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",my:6,px:4,py:6,cursor:"pointer",boxSizing:"border-box",border:"2px solid #fefefe",":hover":{border:"2px solid #00B1A2",boxShadow:"1px 1px 1px 1px #E6E6E6",transition:"0.1s ease-in",backgroundColor:"#D3FFEF"}},id:r.id,draggable:!0,onDragStart:i=>D(i),onDragEnd:i=>D(i),children:[e.jsxs(t,{px:10,children:[e.jsxs(o,{variant:"body1",fontWeight:500,color:"grey.700",children:["Tên giảng viên",e.jsx(o,{mx:4,component:"span",children:r.fullName}),e.jsx(o,{ml:10,component:"span",textAlign:"end"})]}),e.jsxs(o,{variant:"body1",fontWeight:500,color:"grey.700",children:["Mã giảng viên",e.jsx(o,{mx:4,component:"span",children:r.username})]})]}),e.jsx(t,{children:e.jsx(q,{sx:{color:"white"},color:"warning",label:"Chọn để chấm"})})]},r.id))," ",(l==null?void 0:l.length)===2&&e.jsxs(o,{component:"span",variant:"body1",mt:10,fontWeight:"500",color:"error.main",children:[e.jsx(u,{icon:"material-symbols-light:warning-outline"}),"Đã đạt số lượng thành viên tối đa"]}),e.jsxs(o,{variant:"body1",mt:6,color:"primary",children:["Số lượng thành viên:"," ",e.jsxs(o,{component:"span",variant:"body1",mt:10,color:"initial",children:[l==null?void 0:l.length," /2"]})]}),e.jsx(t,{display:"flex",justifyContent:"end",mr:4,mt:10,children:e.jsxs(A,{disabled:l&&(l==null?void 0:l.length)>2,color:"success",variant:"contained",onClick:L,children:[e.jsx(u,{icon:"dashicons:saved"}),"Tạo nhóm"]})})]})]})]})}const te=s=>{if(!s)return[];const d=[];return s.map(a=>{let h=a.lecturer;d.push({...h,lecturerTerm:a,status:g.NO_GROUP})}),d};function oe(){var p;const[s,d]=_.useState(`${I?(p=I[0])==null?void 0:p._id:""}`),[a,h]=_.useState(),{onCreateGroupLecturer:f}=$(),{handleGetListLecturerTerms:j}=Y(),{termStore:b}=B(),{data:w,isLoading:R,isSuccess:F,isFetched:P}=j(),{mutate:L,isSuccess:D}=f(`${s}`),U=()=>{let n=a==null?void 0:a.filter(x=>x.status===g.HAVE_GROUP);const c=n==null?void 0:n.map(x=>x.id);L({termId:b.currentTerm.id,lecturers:c})};_.useEffect(()=>{h(te(w==null?void 0:w.lecturerTerms))},[D,P]);const v=n=>{n.currentTarget.classList.add("dragged"),n.dataTransfer.setData("text/plain",n.currentTarget.id),n.dataTransfer.effectAllowed="move"},T=n=>{n.currentTarget.classList.remove("dragged")},E=n=>{n.preventDefault(),n.currentTarget.classList.add("dragged-over"),n.dataTransfer.dropEffect="move"},O=n=>{let c=n.currentTarget,x=n.relatedTarget;if(x.parentNode===c||x===c)return;n.preventDefault(),n.currentTarget.classList.remove("dragged-over")},l=n=>{n.preventDefault(),n.dataTransfer.dropEffect="move"},y=(n,c,x)=>{n.preventDefault(),n.currentTarget.classList.remove("dragged-over");let C=n.dataTransfer.getData("text/plain"),K=a==null?void 0:a.map(S=>{var G;return((G=S==null?void 0:S.id)==null?void 0:G.toString())===C.toString()&&(S.status=x),S});h(K)};let r=a==null?void 0:a.filter(n=>n.status===g.HAVE_GROUP),i=a==null?void 0:a.filter(n=>n.status===g.NO_GROUP);return e.jsxs(t,{display:"flex",py:10,px:0,gap:20,justifyContent:"space-between",children:[e.jsxs(m,{onDragLeave:n=>O(n),onDragEnter:n=>E(n),onDragEnd:n=>T(n),onDragOver:n=>l(n),onDrop:n=>y(n,!1,g.NO_GROUP),sx:{flex:1},children:[" ",e.jsxs(t,{px:10,bgcolor:"grey.200",py:4,mb:4,children:[e.jsxs(o,{mb:4,variant:"h6",color:"primary",children:[e.jsx(u,{icon:"ic:baseline-list"}),"Danh sách giảng viên trống lịch"]}),e.jsx(t,{sx:{bgcolor:"white"},children:e.jsx(H,{placeholder:"Tim kiem giang vien"})})]}),e.jsx(t,{sx:{overflowY:"auto"},height:500,px:4,children:R||!P?e.jsx(z,{}):e.jsx(t,{children:i==null?void 0:i.map(n=>e.jsx(J,{id:n.id,lecturer:n,draggable:!0,onDragStart:c=>v(c),onDragEnd:c=>v(c)},n.id))})})]}),e.jsxs(m,{sx:{flex:1,px:8,height:400,py:10,borderTop:"5px solid #0052b1"},onDragLeave:n=>O(n),onDragEnter:n=>E(n),onDragEnd:n=>T(n),onDragOver:n=>l(n),onDrop:n=>y(n,!1,g.HAVE_GROUP),children:[e.jsxs(t,{display:"flex",justifyContent:"space-between",children:[e.jsxs(o,{variant:"h6",color:"primary",children:[e.jsx(u,{icon:"gridicons:create"}),"Tạo nhóm chấm báo cáo"]}),e.jsx(t,{children:e.jsx(Z,{value:s,onChange:n=>{d(n.target.value)},options:I})})]}),r&&r.length<1?e.jsx(t,{display:"flex",sx:{cursor:"progress"},flexDirection:"column",children:e.jsxs(t,{display:"flex",flexDirection:"column",gap:10,alignItems:"center",children:[e.jsx(o,{color:"grey.500",variant:"h6",mt:20,children:"Vui lòng kéo thả giảng viên..."}),e.jsx(u,{color:"#dfdfdf",width:100,icon:"icon-park-solid:hand-left"})]})}):e.jsxs(t,{sx:{minHeight:500},children:[r==null?void 0:r.map(n=>e.jsxs(m,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",my:6,py:6,cursor:"pointer",boxSizing:"border-box",border:"2px solid #fefefe",":hover":{border:"2px solid #00B1A2",boxShadow:"1px 1px 1px 1px #E6E6E6",transition:"0.1s ease-in",backgroundColor:"#D3FFEF"}},id:n.id,draggable:!0,onDragStart:c=>v(c),onDragEnd:c=>v(c),children:[e.jsxs(t,{px:10,children:[e.jsxs(o,{variant:"body1",fontWeight:500,color:"grey.700",children:["Tên giảng viên",e.jsx(o,{mx:4,component:"span",children:n.fullName}),e.jsx(o,{ml:10,component:"span",textAlign:"end"})]}),e.jsxs(o,{variant:"body1",fontWeight:500,color:"grey.700",children:["Mã giảng viên",e.jsx(o,{mx:4,component:"span",children:n.username})]})]}),e.jsx(t,{children:e.jsx(q,{sx:{color:"white"},color:"warning",label:"Chọn để chấm"})})]},n.id))," ",(r==null?void 0:r.length)===2&&e.jsxs(o,{component:"span",variant:"body1",mt:10,fontWeight:"500",color:"error.main",children:[e.jsx(u,{icon:"material-symbols-light:warning-outline"}),"Đã đạt số lượng thành viên tối đa"]}),e.jsxs(o,{variant:"body1",mt:4,color:"primary",children:["Số lượng thành viên:"," ",e.jsxs(o,{component:"span",variant:"body1",mt:10,color:"initial",children:[r==null?void 0:r.length," /2"]})]}),e.jsx(t,{display:"flex",justifyContent:"end",mt:10,mr:4,children:e.jsxs(A,{color:"success",variant:"contained",disabled:r&&r.length>2,onClick:U,children:[e.jsx(u,{icon:"dashicons:saved"}),"Tạo nhóm"]})})]})]})]})}function he(){const[s,d]=V.useState("1"),a=(h,f)=>{d(f)};return e.jsx(m,{sx:{py:6,px:10},elevation:1,children:e.jsx(t,{sx:{width:"100%",typography:"body1"},children:e.jsxs(k,{value:s,children:[e.jsx(t,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(ee,{onChange:a,"aria-label":"lab API tabs example",children:[e.jsx(W,{sx:{"&.Mui-selected":{bgcolor:"primary.dark"," > .MuiTypography-root":{color:"white",fontWeight:"bold"}}},label:e.jsx(N,{color:"grey.700",variant:"body1",children:"Phân công chấm Phản biện"}),value:"1"}),e.jsx(W,{sx:{"&.Mui-selected":{bgcolor:"primary.dark"," > .MuiTypography-root":{color:"white",fontWeight:"bold"}}},label:e.jsx(N,{color:"grey.700",variant:"body1",children:"Phân công chấm Báo cáo"}),value:"2"})]})}),e.jsx(M,{value:"1",children:e.jsx(ne,{})}),e.jsx(M,{value:"2",children:e.jsx(oe,{})})]})})})}export{he as default};
