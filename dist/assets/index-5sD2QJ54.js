import{r as g,j as e,B as l,I as p,a as o,a5 as C,E as k,ad as S,T as M,ah as N,ai as F,P as L,bd as H,aC as v,al as P,Z as R,aj as G,aD as _}from"./index-wQ8JwfM2.js";import{T as O,a as V,A as B,D as E}from"./Table-cDawzk-H.js";import{c as U}from"./person.validation-jxi8KQi5.js";import{a as D}from"./index-k6g5FF0C.js";import{a as w,u as I}from"./useQueryLecturerTerm-QglJ35an.js";import"./KeyboardArrowRight-yT4WKBtg.js";import"./index-owcxqeif.js";import"./Stack-xq_Pr2sx.js";function W(c){const{onClose:t,open:a,lecturerId:m,name:d}=c,{onDeleteLecturerTerm:u}=w(),{mutate:i,isSuccess:r}=u(),x=()=>{i(m)};return g.useEffect(()=>{t()},[r]),e.jsx(D,{onClose:t,open:a,children:e.jsxs(l,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",px:10,py:12,children:[e.jsxs(l,{p:10,borderRadius:"50%",sx:{background:"rgba(255,49,111,0.2)"},children:[e.jsx(p,{color:"#b31d1d82",height:70,width:70,icon:"streamline:emergency-exit"})," "]}),e.jsxs(o,{textAlign:"center",variant:"h3",mt:10,mb:14,children:["Bạn có chắc chắn muốn bỏ GV ",d," ra khỏi học kì này?"]}),e.jsxs(l,{width:"100%",display:"flex",gap:6,marginTop:1,children:[e.jsxs(C,{onClick:t,sx:{width:"50%"},color:"primary",variant:"contained",children:[e.jsx(p,{width:20,style:{marginRight:4},icon:"mdi:cancel-outline"}),"Hủy"]}),e.jsxs(C,{type:"submit",sx:{width:"50%"},onClick:x,color:"error",variant:"contained",children:[e.jsx(p,{width:20,style:{marginRight:4},icon:"material-symbols:auto-delete-outline"}),"Bỏ giảng viên"]})]})]})})}function z(c){const{rows:t,totalItems:a,totalPage:m,page:d,handleChangePage:u}=c,[i,r]=g.useState({lecturerId:"",name:"",isOpen:!1}),x=()=>{r({...i,isOpen:!1})},j=(n,y)=>{r({lecturerId:n,name:y,isOpen:!0})},f=[{headerName:"Mã Giảng Viên",field:"username",flex:.6,headerAlign:"center",align:"right",renderCell(n){return e.jsx(o,{variant:"body1",fontWeight:600,children:n.row.username})}},{headerName:"Họ & Tên đệm",field:"firstName",flex:.7,headerAlign:"left",align:"left"},{headerName:"Tên",field:"lastName",flex:.5,headerAlign:"left",align:"left"},{headerName:"Chuyên ngành",field:"majorName",flex:1,headerAlign:"left",align:"left"},{headerName:"Giới tính",field:"gender",flex:.5,headerAlign:"left",align:"left",renderCell:n=>e.jsx(o,{variant:"body1",children:U(n.row.gender)})},{headerName:"Email",field:"email",flex:1.2,headerAlign:"left",align:"left",renderCell:n=>e.jsx(o,{variant:"body1",children:n.row.email})},{headerName:"SĐT",field:"phone",flex:1,headerAlign:"center",align:"center",renderCell:n=>e.jsx(o,{variant:"body1",children:n.row.phone})},{headerName:"Chức năng",field:"updateTing",flex:.5,headerAlign:"center",align:"center",renderCell:n=>e.jsx(l,{display:"flex",gap:2,children:e.jsx(V,{onClick:()=>j(n.row.id,n.row.fullName),title:"Gỡ giảng viên khỏi học kì",children:e.jsx(k,{color:"error",children:e.jsx(p,{width:20,icon:"carbon:close-filled",style:{color:" #f2365b"}})})})})}];return e.jsxs(e.Fragment,{children:[e.jsx(l,{children:e.jsx(O,{rows:t,sx:{bgcolor:"white",width:"100%"},columns:f,totalItems:a,totalPages:m,page:d,handleChangePage:u,disableColumnMenu:!0,disableColumnFilter:!0,disableColumnSelector:!0,minHeight:400})}),e.jsx(W,{lecturerId:i.lecturerId,open:i.isOpen,onClose:x,name:i.name})]})}const Q=c=>c?c.map(t=>({label:t.nameSelect,id:t.lecturerId})):[];function $(c){const{onClose:t,open:a}=c,{termStore:m}=S(),{currentTerm:d}=m,{handleLecturerTermsToAdd:u,onCreateLecturerTerm:i}=w(),{data:r,isLoading:x,isSuccess:j,isFetching:f}=u(),{mutate:n,isSuccess:y}=i(),[h,b]=g.useState({label:"",id:""}),A=s=>{const T={lecturerId:s.id,termId:`${d.id}`};n(T)};return g.useEffect(()=>{t()},[y]),g.useEffect(()=>{a||b({label:"",id:""})},[a]),e.jsx(D,{maxWidth:"sm",open:a,onClose:t,children:e.jsxs(l,{py:10,px:10,children:[e.jsx(M,{mb:8,variant:"h5",textTransform:"uppercase",children:"Thêm Giảng viên vào học kì"}),e.jsx(l,{height:"350px",children:x||f?e.jsx(N,{}):e.jsxs(e.Fragment,{children:[e.jsx(B,{disablePortal:!0,id:"lecturer-terms-list",options:Q(r==null?void 0:r.lecturerTerms),onChange:(s,T)=>{b(T)},onInputChange:(s,T)=>{},renderInput:s=>e.jsx(e.Fragment,{children:e.jsx(F,{...s,placeholder:"Nhập vào tên giảng viên",label:"DANH SÁCH GV KHOA CÔNG NGHỆ THÔNG TIN"})})}),e.jsxs(l,{children:[e.jsx(o,{textTransform:"uppercase",mt:20,mb:4,variant:"body1",fontWeight:"bold",children:"Thông tin giảng viên"}),!h||(h==null?void 0:h.id)===""?e.jsx(e.Fragment,{children:e.jsx(o,{my:10,textAlign:"center",variant:"body1",color:"initial",children:"Chưa chọn giảng viên nào..."})}):e.jsx(l,{children:r==null?void 0:r.lecturerTerms.filter(s=>s.lecturerId===(h==null?void 0:h.id)).map(s=>e.jsxs(L,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",p:3,borderRadius:2,boxShadow:1,mt:4},children:[e.jsx(o,{variant:"h6",component:"div",gutterBottom:!0,sx:{fontWeight:"500",my:4},children:s.fullName}),e.jsx(E,{sx:{width:"100%",mb:2}}),e.jsxs(l,{sx:{my:6},children:[e.jsxs(o,{variant:"body1",color:"text.primary",children:[e.jsx("strong",{children:"Mã GV:"})," ",s.username]}),e.jsxs(o,{variant:"body1",color:"text.primary",children:[e.jsx("strong",{children:"Email:"})," ",s.email]}),e.jsxs(o,{variant:"body1",color:"text.primary",children:[e.jsx("strong",{children:"Trình độ:"})," ",H(s.degree)]}),e.jsxs(o,{variant:"body1",color:"text.primary",children:[e.jsx("strong",{children:"Chuyên ngành:"})," ",s.majorName]})]}),e.jsx(E,{sx:{width:"100%",mb:2}}),e.jsx(o,{variant:"body2",color:"primary.dark",children:s.nameSelect})]}))})]})]})}),e.jsxs(l,{mt:10,justifyContent:"end",gap:4,display:"flex",children:[e.jsxs(C,{variant:"contained",color:"primary",onClick:t,children:[e.jsx(p,{icon:"mdi:close-outline"}),"Hủy"]}),e.jsxs(C,{variant:"contained",color:"error",onClick:()=>A(h),type:"submit",children:[e.jsx(p,{icon:"material-symbols:save-outline"}),"Thêm GV hướng dẫn"]})]})]})})}const K=[{_id:v.SEARCH_FULLNAME,name:"Tên giảng viên"},{_id:v.SEARCH_USERNAME,name:"Mã giảng viên"},{_id:v.SEARCH_PHONE,name:"Số điện thoại"},{_id:v.SEARCH_EMAIL,name:"Email"}];function Z(){const[c,t]=g.useState(!1),a=()=>{t(!1)},m=()=>{t(!0)},{onImportLecturerTerm:d}=w(),{mutate:u}=d(),{onSearchChange:i,getQueryField:r,onTypeSearchChange:x,handleFocused:j}=I(),f=()=>{u()};return e.jsxs(e.Fragment,{children:[e.jsxs(l,{mb:4,display:"flex",flexWrap:"wrap",gap:2,children:[e.jsxs(l,{flex:1,display:"flex",gap:4,width:"full",children:[e.jsx(l,{width:200,children:e.jsx(P,{defaultValue:r("searchField")?r("searchField"):"username",onChange:n=>x(`${n.target.value}`),options:K})}),e.jsx(R,{fullWidth:!0,size:"small",defaultValue:r("keywords"),onChange:i,onBlur:()=>j(!1),placeholder:"Tim kiếm giảng viên HD theo.."})]}),e.jsxs(C,{color:"primary",variant:"contained",onClick:f,children:[e.jsx(p,{icon:"fe:import"}),"Tải lên dữ liệu GV chuyên ngành"]}),e.jsxs(C,{size:"small",color:"error",type:"button",onClick:m,variant:"contained",children:[e.jsx(p,{icon:"lets-icons:add-round",width:20}),"Thêm giảng viên HD"]})]}),e.jsx($,{open:c,onClose:a})]})}function ie(){var b;const{handleGetAllLecturerTermByParam:c,paramTotalPage:t}=w(),{majorStore:a}=G(),{termStore:m}=S(),[d,u]=g.useState(1),{data:i,isLoading:r,isFetching:x,refetch:j}=c(),f=A=>{u(A)},{setLimit:n,setPage:y,getQueryField:h}=I();return g.useEffect(()=>{n(10),y(d)},[d]),g.useEffect(()=>{n(10),y(1),h("keywords")===""&&j()},[h("keywords")]),console.log("🚀 ~ LecturetPage ~ ('isLoading' + isLoading + 'isFeth' + isFetching:","isLoading"+r+"isFeth"+x),e.jsxs(L,{sx:{py:10,px:10},elevation:1,children:[e.jsxs(M,{mb:8,mt:2,children:["Danh sách giảng viên ",a!=null&&a.currentMajor?a.currentMajor.name:""," -"," ",m.currentTerm.name]}),e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),r?e.jsx(N,{}):e.jsx(z,{rows:_(i==null?void 0:i.lecturerTerms),totalPage:t,totalItems:(b=i==null?void 0:i.lecturerTerms)==null?void 0:b.length,handleChangePage:f,page:d})]})]})}export{ie as default};
