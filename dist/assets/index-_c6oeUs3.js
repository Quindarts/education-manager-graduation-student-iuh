import{al as I,aA as y,aj as U,r as E,j as e,B as l,T as G,af as J,ag as W,ai as M,ak as N,am as Q,a5 as R,I as C,a as w,aB as K,E as F,ad as V,aC as A,R as Y,Z as ee,P as ne,ah as re,aD as ae}from"./index-NapbxlsL.js";import{T as le,a as B}from"./Table-WHKjjRLK.js";import{a as $}from"./index-qC6u9U62.js";import{u as P}from"./useQueryLecturer-I1hzz5cM.js";import{v as z}from"./index-xZUW7kk_.js";import{c as te}from"./person.validation-jxi8KQi5.js";import{u as ie}from"./useQueryLecturerTerm-aT1-fx4u.js";import{M as se,T as oe}from"./index-jCkRbMnd.js";import{u as X}from"./useParams-vd7i9Ic6.js";import"./KeyboardArrowRight-5D6Ejjzb.js";import"./index-UQJd2y-u.js";import"./Stack-ScuxqrBn.js";import"./useQueryGroupLecturer-YqNk0Zqv.js";import"./apiStudent-jSxWDoLW.js";const de=[{_id:I.FEMALE,name:"Nữ"},{_id:I.MALE,name:"Nam"}];y.LECTURER,y.HEAD_LECTURER,y.HEAD_COURSE,y.ADMIN;const ce=[{name:"Tiến sĩ",_id:"MASTER"},{name:"Thạc sĩ",_id:"DOCTOR"}];function me(u){var x,T,S,r,L,v,k;const{onClose:i,open:d,lecturerId:s}=u,{majorStore:c}=U(),{handleGetLecturerById:o,onUpdateLecturer:h}=P(),{data:n,isLoading:p,isFetched:g}=o(s),{mutate:j,isSuccess:a}=h(s),t=f=>{j(f)};return E.useEffect(()=>{i()},[a]),e.jsx($,{maxWidth:"xs",open:d,onClose:i,children:e.jsxs(l,{py:10,px:10,children:[e.jsx(G,{mb:6,textTransform:"uppercase",children:"Cập nhật thông tin Giảng viên"}),p&&!g?e.jsx(l,{m:"auto",height:500,children:e.jsx(J,{})}):e.jsx(W,{onSubmit:f=>{t(f)},validationSchema:z,initialValues:{fullName:`${(x=n==null?void 0:n.lecturer)==null?void 0:x.fullName}`,username:`${(T=n==null?void 0:n.lecturer)==null?void 0:T.username}`,email:`${(S=n==null?void 0:n.lecturer)==null?void 0:S.email}`,phone:`${(r=n==null?void 0:n.lecturer)==null?void 0:r.phone}`,gender:`${(L=n==null?void 0:n.lecturer)==null?void 0:L.gender}`,degree:`${(v=n==null?void 0:n.lecturer)==null?void 0:v.degree}`,majorId:`${(k=n==null?void 0:n.lecturer)==null?void 0:k.majorId}`},children:({values:f,touched:b,handleChange:D,handleBlur:H,handleSubmit:Z,errors:m,setFieldValue:O})=>e.jsxs("form",{onSubmit:Z,children:[e.jsx(M,{value:f.username,name:"username",label:"Mã giảng viên",placeholder:"Mã Giảng viên",disabled:!0,onChange:D,onBlur:H,error:!!(m.username&&b.username),helperText:`${m.username&&b.username?m.username:""}`}),e.jsxs(l,{display:"flex",gap:10,mt:8,children:[e.jsx(l,{width:"100%",children:e.jsx(M,{required:!0,value:f.fullName,name:"fullName",label:"Họ và tên",onChange:D,onBlur:H,placeholder:"Họ và tên",error:!!(m.fullName&&b.fullName),helperText:`${m.fullName&&b.fullName?m.fullName:""}`})}),e.jsx(l,{width:200,children:e.jsx(N,{sx:{mb:8},value:`${f.gender}`,onChange:_=>{O("gender",_.target.value)},label:"Giới tính",options:de})})]}),e.jsx(M,{required:!0,name:"phone",value:f.phone,label:"Số điện thoại",placeholder:"Nhập vào số điện thoại",onChange:D,onBlur:H,error:!!(m.phone&&b.phone),helperText:`${m.phone&&b.phone?m.phone:""}`}),e.jsx(M,{required:!0,value:f.email,name:"email",label:"Email",placeholder:"Nhập vào email",onChange:D,onBlur:H,error:!!(m.email&&b.email),helperText:`${m.email&&b.email?m.email:""}`}),e.jsx(l,{mt:8,width:"full",children:e.jsx(N,{label:"Chuyên ngành",value:f.majorId,onChange:_=>{O("majorId",_.target.value)},options:Q(c.allMajor)})})," ",e.jsx(l,{mt:8,width:"full"}),e.jsx(l,{mt:8,width:"full",children:e.jsx(N,{label:"Trình độ",value:f.degree,onChange:_=>{O("degree",_.target.value)},options:ce})})," ",e.jsxs(l,{mt:10,justifyContent:"end",gap:4,display:"flex",children:[e.jsxs(R,{variant:"contained",color:"primary",onClick:i,children:[e.jsx(C,{icon:"mdi:close-outline"}),"Hủy"]}),e.jsxs(R,{variant:"contained",color:"success",type:"submit",children:[e.jsx(C,{icon:"material-symbols:save-outline"}),"Cập nhật giảng viên"]})]})]})})]})})}function ue(u){const{onClose:i,open:d,lecturerId:s}=u,{onDeleteLecturerTerm:c}=ie(),{mutate:o,isSuccess:h}=c(),n=()=>{o(s)};return E.useEffect(()=>{i()},[h]),e.jsx($,{onClose:i,open:d,children:e.jsxs(l,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",px:10,py:12,children:[e.jsxs(l,{borderRadius:"50%",padding:3,sx:{background:"rgba(255,49,111,0.2)"},children:[e.jsx(C,{color:"#b31d1d82",height:70,width:70,icon:"fa-solid:trash-restore"})," "]}),e.jsx(w,{variant:"h3",mt:10,mb:14,children:"Bạn có chắc chắn muốn xóa giảng viên này ?"}),e.jsxs(l,{width:"100%",display:"flex",gap:6,marginTop:1,children:[e.jsxs(R,{onClick:i,sx:{width:"50%"},color:"primary",variant:"contained",children:[e.jsx(C,{width:20,style:{marginRight:4},icon:"mdi:cancel-outline"}),"Hủy"]}),e.jsxs(R,{type:"submit",sx:{width:"50%"},onClick:n,color:"error",variant:"contained",children:[e.jsx(C,{width:20,style:{marginRight:4},icon:"material-symbols:auto-delete-outline"}),"Xóa giảng viên"]})]})]})})}function he(u){const{rows:i,totalItems:d,currentTermId:s,totalPage:c,page:o,handleChangePage:h}=u,n=K(),[p,g]=E.useState({lecturerId:"",isOpen:!1}),j=()=>{g({...p,isOpen:!1})},a=r=>{g({lecturerId:r,isOpen:!0})},[t,x]=E.useState({lecturerId:"",isOpen:!1}),T=()=>{x({...t,isOpen:!1})},S=[{headerName:"Mã Giảng Viên",field:"username",flex:.6,headerAlign:"center",align:"right",renderCell(r){return e.jsx(w,{variant:"body1",fontWeight:600,children:r.row.username})}},{headerName:"Họ & Tên đệm",field:"firstName",flex:.7,headerAlign:"left",align:"left"},{headerName:"Tên",field:"lastName",flex:.5,headerAlign:"left",align:"left"},{headerName:"Giới tính",field:"gender",flex:.5,headerAlign:"left",align:"left",renderCell:r=>e.jsx(w,{variant:"body1",children:te(r.row.gender)})},{headerName:"SĐT",field:"phone",flex:1,headerAlign:"center",align:"center",renderCell:r=>e.jsx(w,{variant:"body1",children:r.row.phone})},{headerName:"Email",field:"email",flex:1.2,headerAlign:"left",align:"left",renderCell:r=>e.jsx(w,{variant:"body1",children:r.row.email})},{headerName:"",field:"updateTing",flex:1,headerAlign:"center",align:"center",renderCell:r=>e.jsxs(l,{display:"flex",gap:2,children:[e.jsx(B,{title:"Cập nhật thông tin",children:e.jsx(F,{onClick:()=>a(r.row.id),children:e.jsx(C,{icon:"solar:pen-2-bold"})})}),e.jsx(l,{}),e.jsx(B,{title:"Xem Chi tiết",children:e.jsx(F,{color:"primary",onClick:()=>n(`/lecturers/detail/${r.row.id}`),children:e.jsx(C,{width:20,icon:"fluent:apps-list-detail-20-filled"})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(l,{children:e.jsx(le,{rows:i,sx:{bgcolor:"white",width:"100%"},columns:S,totalItems:d,totalPages:c,page:o,handleChangePage:h,disableColumnMenu:!0,disableColumnFilter:!0,disableColumnSelector:!0,minHeight:400})}),e.jsx(me,{lecturerId:p.lecturerId,open:p.isOpen,onClose:j,currentTermId:s}),e.jsx(ue,{lecturerId:t.lecturerId,open:t.isOpen,onClose:T})]})}const pe=[{_id:I.FEMALE,name:"Nữ"},{_id:I.MALE,name:"Nam"}];y.LECTURER,y.HEAD_LECTURER,y.HEAD_COURSE,y.ADMIN;const q=[{name:"Thạc sĩ",_id:"DOCTOR"},{name:"Tiến sĩ",_id:"MASTER"}];function ge(u){var j;const{onClose:i,open:d}=u,{termStore:s}=V(),{majorStore:c}=U(),{currentTerm:o}=s,{onCreateLecturer:h}=P(),{mutate:n,isSuccess:p}=h(),g=a=>{var t={username:a.username,fullName:a.fullName,gender:a.gender,email:a.email,phone:a.phone,degree:a.degree,role:"LECTURER",majorId:a.majorId,termId:o.id};n(t)};return E.useEffect(()=>{i()},[p]),e.jsx($,{maxWidth:"xs",open:d,onClose:i,children:e.jsxs(l,{py:10,px:10,children:[e.jsx(G,{mb:8,variant:"h5",textTransform:"uppercase",children:"Tạo thông tin Giảng viên"}),e.jsx(W,{onSubmit:a=>{g(a)},validationSchema:z,initialValues:{fullName:"",username:"",email:"",phone:"",gender:I.MALE,role:"",degree:(j=q[0])==null?void 0:j._id,majorId:`${c.currentMajor.id}`},children:({values:a,touched:t,handleChange:x,handleBlur:T,handleSubmit:S,errors:r,setFieldValue:L})=>e.jsxs("form",{onSubmit:S,children:[e.jsx(M,{required:!0,value:a.username,name:"username",label:"Mã giảng viên",placeholder:"Mã Giảng viên",onChange:x,onBlur:T,error:!!(r.username&&t.username),helperText:r.username&&t.username?r.username:""}),e.jsxs(l,{display:"flex",gap:10,mt:8,children:[e.jsx(l,{width:"100%",children:e.jsx(M,{required:!0,value:a.fullName,name:"fullName",label:"Họ và tên",onChange:x,onBlur:T,placeholder:"Họ và tên",error:!!(r.fullName&&t.fullName),helperText:r.fullName&&t.fullName?r.fullName:""})}),e.jsx(l,{width:200,children:e.jsx(N,{sx:{mb:8},value:`${a.gender}`,onChange:v=>{L("gender",v.target.value)},label:"Giới tính",options:pe})})]}),e.jsx(M,{required:!0,name:"phone",value:a.phone,label:"Số điện thoại",placeholder:"Nhập vào số điện thoại",onChange:x,onBlur:T,error:!!(r.phone&&t.phone),helperText:r.phone&&t.phone?r.phone:""}),e.jsx(M,{required:!0,value:a.email,name:"email",label:"Email",placeholder:"Nhập vào email",onChange:x,onBlur:T,error:!!(r.email&&t.email),helperText:r.email&&t.email?r.email:""}),e.jsx(l,{mt:8,width:"full",children:e.jsx(N,{label:"Chuyên ngành",value:c.currentMajor.id,disabled:!0,onChange:v=>{L("majorId",v.target.value)},options:Q(c.allMajor)})})," ",e.jsx(l,{mt:8,width:"full",children:e.jsx(N,{label:"Trình độ",value:a.degree,onChange:v=>{L("degree",v.target.value)},options:q})})," ",e.jsxs(l,{mt:10,justifyContent:"end",gap:4,display:"flex",children:[e.jsxs(R,{variant:"contained",color:"primary",onClick:i,children:[e.jsx(C,{icon:"mdi:close-outline"}),"Hủy"]}),e.jsxs(R,{variant:"contained",color:"success",type:"submit",children:[e.jsx(C,{icon:"material-symbols:save-outline"}),"Tạo giảng viên"]})]})]})})]})})}const xe=[{_id:A.SEARCH_FULLNAME,name:"Tên giảng viên"},{_id:A.SEARCH_USERNAME,name:"Mã giảng viên"},{_id:A.SEARCH_PHONE,name:"Số điện thoại"},{_id:A.SEARCH_EMAIL,name:"Email"}];function fe(){const[u,i]=E.useState(!1),{onSearchChange:d,getQueryField:s,onTypeSearchChange:c,handleFocused:o,setDefaultTypeSearch:h}=X(),n=()=>{i(!1)},p=()=>{i(!0)},{termStore:g}=V(),{currentTerm:j}=g,a=()=>(h(A.SEARCH_USERNAME),A.SEARCH_USERNAME);return e.jsxs(e.Fragment,{children:[e.jsxs(l,{mb:4,display:"flex",flexWrap:"wrap",gap:2,children:[e.jsxs(l,{flex:1,display:"flex",gap:4,width:"full",children:[e.jsx(l,{width:200,children:e.jsx(N,{value:s("searchField")?s("searchField"):a,onChange:t=>c(`${t.target.value}`),options:xe})}),e.jsx(ee,{fullWidth:!0,size:"small",defaultValue:s("keywords"),onChange:d,onBlur:()=>o(!1),placeholder:"Tim kiếm giảng viên theo.."})]}),e.jsxs(R,{size:"small",color:"error",type:"button",onClick:p,variant:"contained",children:[e.jsx(C,{icon:"lets-icons:add-round",width:20}),"Tạo giảng viên"]}),e.jsx(se,{label:"Tải lên Excel Giảng viên",entityUpload:oe.LECTURER,termId:j.id})]}),e.jsx(ge,{open:u,onClose:n})]})}const je=Y.memo(fe);function Ie(){const{handleGetAllLecturer:u,paramTotalPage:i}=P(),{majorStore:d}=U();E.useState(10);const[s,c]=E.useState(1),{data:o,isLoading:h,isFetching:n,refetch:p}=u(),{setLimit:g,setPage:j,getQueryField:a}=X();E.useEffect(()=>{g(10),j(s)},[s]),E.useEffect(()=>{g(10),a("keywords")===""&&p()},[a("keywords")]);const t=x=>{c(x)};return e.jsxs(ne,{sx:{py:10,px:10},elevation:1,children:[e.jsxs(G,{mb:8,mt:2,children:["Danh sách giảng viên ",d!=null&&d.currentMajor?d.currentMajor.name:""]}),e.jsxs(e.Fragment,{children:[e.jsx(je,{}),h||n?e.jsx(re,{}):e.jsx(he,{rows:ae(o==null?void 0:o.lecturers),totalPage:i,totalItems:o==null?void 0:o.lecturers.length,handleChangePage:t,page:s})]})]})}export{Ie as default};
