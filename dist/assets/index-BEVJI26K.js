import{aQ as L,U as R,aR as O,D as V,aS as W,q as A,a4 as H,aT as U,aU as z,i as Q,K as J,H as K,J as X,t as Y,at as Z,aV as ee,aW as N,j as e,aX as re,B as c,a as d,aw as w,ad as te,ax as _,r as I,aG as ne,aH as oe,I as F,aI as ae,ah as b,P as j,T as k}from"./index-wQ8JwfM2.js";import{C as se,G as ie}from"./index-owcxqeif.js";import{u as T}from"./useQueryTranscript-GGNiskxk.js";function ce(r,t){return()=>null}function ue(r,t){return()=>null}function le(r,t,n,a,l){return null}const de={configure:r=>{L.configure(r)}},pe=Object.freeze(Object.defineProperty({__proto__:null,capitalize:R,createChainedFunction:O,createSvgIcon:V,debounce:W,deprecatedPropType:ce,isMuiElement:A,ownerDocument:H,ownerWindow:U,requirePropFactory:ue,setRef:z,unstable_ClassNameGenerator:de,unstable_useEnhancedEffect:Q,unstable_useId:J,unsupportedProp:le,useControlled:K,useEventCallback:X,useForkRef:Y,useIsFocusVisible:Z},Symbol.toStringTag,{value:"Module"}));var C={},y={};const he=ee(pe);var E;function D(){return E||(E=1,function(r){"use client";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return t.createSvgIcon}});var t=he}(y)),y}var me=N;Object.defineProperty(C,"__esModule",{value:!0});var P=C.default=void 0,ge=me(D()),xe=e;P=C.default=(0,ge.default)((0,xe.jsx)("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"}),"BookmarkBorder");var G={},fe=N;Object.defineProperty(G,"__esModule",{value:!0});var B=G.default=void 0,ve=fe(D()),Se=e;B=G.default=(0,ve.default)((0,Se.jsx)("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2"}),"Bookmark");function je(r){const{handleSetCurrentGroupChecked:t,groupStudentId:n,topicName:a,groupName:l}=r;return e.jsxs(re,{sx:{display:"flex",gap:4,px:4,py:2},children:[e.jsx(c,{children:e.jsx(se,{color:"success",icon:e.jsx(P,{}),checkedIcon:e.jsx(B,{}),onChange:s=>t(n,s.target.checked)})}),e.jsx(c,{children:e.jsxs(d,{color:"primary",variant:"body1",children:["Tên đề tài",e.jsx(d,{ml:2,component:"span",variant:"body1",color:"grey.700",children:a}),e.jsx(d,{color:"primary",variant:"body1",children:e.jsx(d,{ml:2,component:"span",variant:"body1",color:"grey.700",children:l})})]})})]})}const ye=r=>w.get(`/api/v1/transcripts/lecturer-supports?termId=${r}`),Ie=r=>w.get(`/api/v1/transcripts/lecturer-supports/group-student-to-scoring?termId=${r}`);function be(){const{termStore:r}=te();return{handleGetMyGroupSupport:a=>_(["getMyGroupSupport",r.currentTerm.id],()=>ye(r.currentTerm.id)),handleGetStudentMemberToScoring:a=>_(["getStudentMemberToScoring",r.currentTerm.id],()=>Ie(r.currentTerm.id))}}var Te=(r,t)=>{var n=[],a=[];if(t!==void 0&&t.length<=0)n=r;else for(let s=0;s<r.length;s++){let u=r[s],p=!1;t.map(i=>{u.id===i.evaluationId&&(n.push({...u,isExist:!0,transcriptId:i.id,oldScore:i.score}),a.push(i.score),p=!0)}),p||n.push({...u})}const l=Ce(a);return{newEvaluation:n,total:l}};const Ce=r=>r.reduce((t,n)=>t+n,0);function Ge(r){const{student:t,evaluations:n}=r,[a,l]=I.useState({newEvaluation:[],total:0}),{handleGetTranscriptsByTypeEvaluation:s}=T(),{data:u,isLoading:p,isFetching:i}=s("advisor",t.studentId),{onCreateTranscript:x,onUpdateTranscript:f}=T(),{mutate:h,isSuccess:v}=x(t.studentId,"advisor"),{mutate:M,isSuccess:S}=f(t.studentId);I.useEffect(()=>{l({newEvaluation:[],total:0}),u!==void 0&&l(Te(n,u==null?void 0:u.transcripts))},[v,i,S,t]);const m=n.map(o=>o.scoreMax).reduce((o,g)=>o+g,0);return e.jsx(e.Fragment,{children:e.jsxs(ne,{sx:{mb:4},children:[e.jsx(oe,{sx:{bgcolor:"grey.100"},expandIcon:e.jsx(ie,{color:"primary"}),children:e.jsxs(c,{display:"flex",gap:4,children:[e.jsx(F,{width:20,icon:"flat-color-icons:folder"}),e.jsxs(d,{fontWeight:"500",color:"primary.main",variant:"body1",children:[t.fullName," - MSSV: ",t.username]}),e.jsxs(d,{justifyContent:"end",fontWeight:"500",color:"grey.500",variant:"body1",children:["Nhóm Sinh viên ",t.groupStudentName]})]})}),e.jsx(ae,{children:p||i?e.jsx(b,{}):e.jsxs(c,{display:"flex",flexDirection:"column",gap:4,children:[a.newEvaluation.map((o,g)=>e.jsx(e.Fragment,{})),e.jsx(c,{my:4,display:"flex",gap:100,alignSelf:"end",py:4,px:0,children:e.jsxs(d,{fontWeight:"500",variant:"h5",color:"error",children:["Tổng Điểm :",a.total," / ",m," "]})})]})})]})})}function Ee(){var m;const[r,t]=I.useState([]),{handleGetMyGroupSupport:n,handleGetStudentMemberToScoring:a}=be(),{hanleGetEvalutaionsForScoring:l}=T(),{data:s,isLoading:u,isFetching:p}=n(),{data:i,isLoading:x,isFetching:f}=l("advisor"),{data:h,isLoading:v,isFetching:M}=a(),S=(o,g)=>{if(g===!0)t([...r,o]);else{const $=r.filter(q=>q!==o);t($)}};return e.jsxs(j,{sx:{py:20,px:10},elevation:1,children:[e.jsx(k,{children:"Chấm điểm nhóm sinh viên hướng dẫn"}),e.jsxs(c,{minHeight:"80vh",display:"flex",mt:10,gap:10,children:[e.jsxs(j,{sx:{px:8,py:10,width:"calc(40% - 10px)"},children:[e.jsx(k,{color:"grey.900",variant:"body1",children:"Danh sách nhóm mà bạn đang hướng dẫn"}),e.jsx(c,{width:"full",display:"flex",flexDirection:"column",mt:6}),e.jsx(c,{component:"section",mt:8,display:"flex",flexDirection:"column",gap:6,children:u||p?e.jsx(b,{}):s==null?void 0:s.groupStudents.map(o=>e.jsx(je,{groupName:o.groupStudentName,topicName:o.topicName,groupStudentId:o.groupStudentId,handleSetCurrentGroupChecked:S}))})]}),e.jsx(j,{sx:{px:8,py:10,width:"60%"},children:r.length<1?e.jsx(c,{display:"flex",sx:{cursor:"progress"},flexDirection:"column",height:500,children:e.jsxs(c,{display:"flex",flexDirection:"column",gap:10,alignItems:"center",children:[e.jsx(d,{color:"primary.main",variant:"h6",mt:20,fontWeight:600,children:"Vui lòng Chọn sinh viên trong danh sách sinh viên bên trái để chấm điểm ...."}),e.jsx(F,{color:"#dfdfdf",width:200,icon:"icon-park-solid:hand-left"})]})}):e.jsx(e.Fragment,{children:v||M||x||f?e.jsx(b,{}):e.jsx(c,{width:"100%",my:4,children:(m=h==null?void 0:h.groupStudentMembers)==null?void 0:m.filter(o=>r.includes(o.groupStudentId)).map(o=>e.jsx(Ge,{student:o,evaluations:i==null?void 0:i.evaluations}))})})})]})]})}export{Ee as default};
