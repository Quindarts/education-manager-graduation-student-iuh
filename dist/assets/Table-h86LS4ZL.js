import{ao as k,ad as N,ay as C,az as j,aJ as G,r as f,j as e,B as n,I as u,a as d,a5 as x,ah as R,W as B,al as O,A as T,bd as w,E as F}from"./index-wQ8JwfM2.js";import{T as q,a as E}from"./Table-cDawzk-H.js";import{Q as y,a as Q,r as z,u as D}from"./useQueryGroupLecturer-Sp-7QLMU.js";import{a as I}from"./index-k6g5FF0C.js";import{a as K}from"./useQueryLecturerTerm-QglJ35an.js";const A=()=>{const{enqueueSnackbar:t}=k(),{termStore:a}=N(),i=a.currentTerm.id;return{onRemoveMemberFromGroupLecturer:s=>C(o=>z(s,o),{onSuccess:o=>{t("Xóa giảng viên khỏi nhóm thành công",{variant:"success"}),j.invalidateQueries({queryKey:[y.getGroupLecturerById,s]}),j.invalidateQueries({queryKey:[y.getAllGroupLecturerByTypeGroup,"reviewer",i]})},onError:()=>{t("Tạo nhóm giảng viên thất bại",{variant:"error"})}}),onAddMemberToGroupLecturer:s=>C(o=>Q(s,o),{onSuccess:o=>{t("Thêm giảng viên vào nhóm thành công",{variant:"success"}),j.invalidateQueries({queryKey:[y.getGroupLecturerById,s]}),j.invalidateQueries({queryKey:[y.getAllGroupLecturerByTypeGroup,"reviewer"]})},onError:()=>{t("Tạo nhóm giảng viên thất bại",{variant:"error"})}})}};function H(t){const{onClose:a,open:i,lecturerId:c}=t,{pathname:l}=G(),s=l.split("/"),o=`${s[s.length-1]}`,{onRemoveMemberFromGroupLecturer:p}=A(),{mutate:h,isSuccess:g}=p(o),m=()=>{h({lecturerId:c})};return f.useEffect(()=>{a()},[g]),e.jsx(I,{onClose:a,open:i,children:e.jsxs(n,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",px:10,py:12,children:[e.jsxs(n,{borderRadius:"50%",width:100,height:100,display:"flex",alignItems:"center",justifyContent:"center",sx:{background:"rgba(255,49,111,0.2)"},children:[e.jsx(u,{color:"#b31d1d82",width:70,icon:"fluent-mdl2:leave"})," "]}),e.jsx(d,{variant:"h3",mt:10,mb:14,children:"Xóa giảng viên ra khỏi nhóm ?"}),e.jsxs(n,{width:"100%",display:"flex",gap:6,marginTop:1,children:[e.jsxs(x,{onClick:a,sx:{width:"50%"},color:"primary",variant:"contained",children:[e.jsx(u,{width:20,style:{marginRight:4},icon:"mdi:cancel-outline"}),"Hủy"]}),e.jsxs(x,{onClick:m,type:"submit",sx:{width:"50%"},color:"error",variant:"contained",children:[e.jsx(u,{width:20,style:{marginRight:4},icon:"fluent-mdl2:leave"}),"Xóa Giảng viên"]})]})]})})}const W=t=>{let a=[];return t==null?[]:(t==null||t.map(i=>{var c,l,s;a.push({_id:(c=i.lecturer)==null?void 0:c.id,name:((l=i.lecturer)==null?void 0:l.fullName)+" - "+((s=i==null?void 0:i.lecturer)==null?void 0:s.username)})}),a)};function X(t){const{onClose:a,open:i,groupType:c}=t,[l,s]=f.useState(""),{handleGetListLecturerTerms:o}=K(),{pathname:p}=G(),h=p.split("/"),g=`${h[h.length-1]}`,{data:m,isLoading:v,isFetching:b}=o(),{onAddMemberToGroupLecturer:L}=A(),{mutate:M}=L(g),r=()=>{M(l)};return e.jsx(I,{open:i,onClose:a,children:e.jsxs(n,{m:10,children:[e.jsx(d,{mb:4,fontWeight:600,variant:"h3",children:"Thêm Giảng viên vào nhóm"}),e.jsx(n,{my:10,children:v||b?e.jsx(R,{}):e.jsx(B,{sx:{width:"100%"},children:e.jsx(O,{onChange:S=>{s(S.target.value)},options:W(m.lecturerTerms)})})}),e.jsxs(n,{mt:12,sx:{display:"flex",gap:3},children:[e.jsxs(x,{onClick:a,sx:{width:"50%"},variant:"contained",color:"primary",children:[e.jsx(u,{width:20,style:{marginRight:4},icon:"mdi:cancel-outline"}),"Hủy"]}),e.jsxs(x,{onClick:r,type:"submit",sx:{width:"50%"},variant:"contained",color:"error",children:[e.jsx(u,{width:20,icon:"radix-icons:plus"}),"Thêm Giảng viên"]})]})]})})}function _(t){const{rows:a,groupType:i}=t,[c,l]=f.useState({isOpen:!1,lecturerId:""}),{handleUiRender:s}=D(),o=s(),p=r=>{l({lecturerId:r,isOpen:!0})},h=()=>{l(r=>({...r,isOpen:!1}))},[g,m]=f.useState(!1),v=()=>{m(!0)},b=()=>{m(!1)},L=[{headerName:"Thông tin chung",field:"name",flex:1.5,headerAlign:"center",renderCell:r=>e.jsxs(n,{gap:4,display:"flex",alignItems:"center",children:[e.jsx(T,{sizes:"small",src:r.row.avatar}),e.jsxs(n,{children:[e.jsx(d,{fontWeight:600,variant:"body1",children:r.row.fullName}),e.jsxs(d,{children:["Mã SV: ","  ",e.jsx(d,{component:"span",children:r.row.username})]})]})]})},{headerName:"Chuyên ngành",field:"majorName",flex:1,align:"center",headerAlign:"center"},{headerName:"Trình độ",field:"degree",flex:1,align:"center",headerAlign:"center",renderCell:r=>e.jsx(n,{children:w(r.row.degree)})}],M=[{headerName:"Thông tin chung",field:"name",flex:1.5,headerAlign:"center",renderCell:r=>e.jsxs(n,{gap:4,display:"flex",alignItems:"center",children:[e.jsx(T,{sizes:"small",src:r.row.avatar}),e.jsxs(n,{children:[e.jsx(d,{fontWeight:600,variant:"body1",children:r.row.fullName}),e.jsxs(d,{children:["Mã SV: ","  ",e.jsx(d,{component:"span",children:r.row.username})]})]})]})},{headerName:"Chuyên ngành",field:"majorName",flex:1,align:"center",headerAlign:"center"},{headerName:"Trình độ",field:"degree",flex:1,align:"center",headerAlign:"center",renderCell:r=>e.jsx(n,{children:w(r.row.degree)})},{headerName:"",field:"name8",flex:1,align:"center",headerAlign:"center",renderCell:r=>e.jsx(n,{display:"flex",gap:2,children:e.jsx(E,{title:"Mời rời nhóm",children:e.jsx(F,{size:"small",color:"primary",onClick:()=>p(r.row.id),children:e.jsx(u,{icon:"pepicons-print:leave-circle",width:20})})})})}];return e.jsxs(e.Fragment,{children:[e.jsx(n,{children:e.jsxs(n,{children:[e.jsx(n,{display:"flex",mt:6,mb:4,justifyContent:"end",children:o.includes("all")&&e.jsxs(x,{size:"small",onClick:v,color:"error",disabled:a.length>=2,variant:"contained",children:[e.jsx(u,{icon:"material-symbols:add",width:16,style:{marginRight:4}}),"Thêm Giảng viên"]})}),e.jsx(q,{rows:a,sx:{bgcolor:"white",height:250},minHeight:250,columns:o.includes("all")?M:L,totalItems:1,totalPages:1,page:1,handleChangePage:()=>{},disableColumnMenu:!0,disableColumnFilter:!0,disableColumnSelector:!0})]})}),e.jsx(H,{onClose:h,open:c.isOpen,lecturerId:c.lecturerId}),e.jsx(X,{groupType:i,onClose:b,open:g})]})}export{_ as T};
